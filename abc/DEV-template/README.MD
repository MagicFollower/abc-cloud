#### åç«¯å¼€å‘è§„èŒƒ

æ—¶é—´ï¼š2023å¹´05æœˆ04æ—¥ 18:51:29

---

#### ğŸŒµæ§åˆ¶å™¨ï¼ˆControllerï¼‰

##### 1.1 å…¥å‚

> æˆ‘ä»¬çº¦å®šå…¥å‚ä»¥`AaaReq`å‘½åï¼›
>
> Controllerå±‚æ–¹æ³•æ¥æ”¶çš„å‚æ•°`A`å’ŒServiceå±‚æ–¹æ³•æ¥æ”¶çš„å‚æ•°`B`æœ‰éƒ¨åˆ†å·®å¼‚ï¼Œå‰è€…`A`å°†ç›´æ¥å¤„ç†è§†å›¾ä¼ å…¥çš„æ•°æ®ï¼Œåè€…`B`å‚æ•°æ˜¯ä¸šåŠ¡å¿…é¡»å‚æ•°ï¼ˆä¸éœ€è¦åŒ…å«`A`ä¸­æ‰€æœ‰æ•°æ®ï¼‰
>
> - ç³»ç»Ÿä¾§å°†æä¾›`AbstractRequest`ï¼Œå†…éƒ¨å°è£…äº†è‡ªå®šä¹‰çš„`PageInfo`ï¼ŒControllerå±‚å¯åœ¨`AbstractRequest`åŸºç¡€ä¸Šæ´¾ç”Ÿ`AbstractBaseRequest`ï¼Œå…·ä½“çš„è¯·æ±‚ä½“ç»§æ‰¿è‡ªæ´¾ç”Ÿå‡ºçš„æŠ½è±¡ç±»ï¼ˆServiceå±‚å…¥å‚åˆ™ç›´æ¥ç»§æ‰¿`AbstractRequest`ï¼‰

##### 1.2 å“åº”

> æˆ‘ä¹ˆçº¦å®šControllerå±‚è¿”å›ç±»å‹ç»Ÿä¸€å°è£…ä¸º`ResponseData`
>
> - *<u>**success:Boolean**</u>*
> - *<u>**code:int**</u>*
>   - *<u>**message:String**</u>*
> - *<u>**T:result**</u>*
> - *<u>**timestamp:longï¼ˆé»˜è®¤å¡«å……ï¼‰**</u>*
>
> å½“ç„¶ï¼Œä¼šæä¾›ä¸€ä¸ªå·¥å…·ç±»`ResponseProcessor`ï¼Œç”¨äºå¿«é€Ÿå¾—åˆ°æ ¼å¼æ­£ç¡®å’Œé”™è¯¯çš„`ResponseData`

##### 1.3 Controllerä¸­é€»è¾‘æ¨¡æ¿

> ç¬¬ä¸€æ­¥ï¼šè§£æ`AaaReq`ï¼Œå°†é€‚åˆçš„æ•°æ®å¡«å……åˆ°Serviceå±‚çš„å‚æ•°`AaaRequest`ä¸­ï¼›
>
> ç¬¬äºŒæ­¥ï¼šè°ƒç”¨æœåŠ¡ï¼›
>
> ç¬¬ä¸‰æ­¥ï¼šå¤„ç†ç»“æœ
>
> - æƒ…å†µä¸€ï¼šæ­£å¸¸å¾—åˆ°å“åº”
>
>   - ```java
>     // æŸ¥è¯¢ï¼ˆåç«¯å…¨éƒ¨åˆ†é¡µï¼Œåˆ†é¡µå‚æ•°ç”±å‰ç«¯æ§åˆ¶ï¼Œä¸æƒ³è¦åˆ†é¡µæ—¶ï¼Œå‰ç«¯æ”¾å¤§åˆ†é¡µå‚æ•°å³å¯ï¼‰
>     PageResponse pageResponse = new PagerResponse(åˆ—è¡¨, total);
>     new ResponseProcessor<PageResponse<åˆ—è¡¨æ³›å‹>>().setData(pageResponse, response.getMsg())
>     ```
>
>   - ```java
>     // æ•°æ®å›å¡«ï¼ˆé€‚ç”¨äºæ–°å¢ï¼‰
>     new ResponseProcessor<åˆ—è¡¨æ³›å‹>().setData(åˆ—è¡¨, response.getMsg())
>     ```
>
>   - ```java
>     // æ›´æ–°ã€åˆ é™¤ã€å¯åœ
>     new ResponseProcessor<>().setData(null, response.getMsg())
>     ```
>
> - ğŸ’¥æƒ…å†µäºŒï¼šæ•è· <u>*BaseException*</u>ï¼ˆ`BizExceptionçš„çˆ¶ç±»`ï¼‰
>
>   - ```java
>     // é”™è¯¯æ—¥å¿—é”šç‚¹ä½¿ç”¨ä¸‰å‚æ•°log.error
>     log.error(">>>>xxx|xxx|xxx:{}<<<", be.getMessage(), be)
>     new ResponseData<>().setErrorMessage(be.getErrorCode, be.getMessage);
>     ```
>
> - ğŸ’¥æƒ…å†µä¸‰ï¼šæ•è·æœªçŸ¥Exception
>
>   - ```java
>     // é”™è¯¯æ—¥å¿—é”šç‚¹ä½¿ç”¨ä¸‰å‚æ•°log.error
>     log.error(">>>>xxx|xxx|xxx:{}<<<", e.getMessage(), e)
>     new ResponseData<>()
>     .setErrorMessage(SystemReturnCodeConstants.SYSTEM_ERROR.getCode(),SystemReturnCodeConstants.SYSTEM_ERROR.getMessage());
>     ```





#### ğŸŒµServiceï¼ˆæœåŠ¡å±‚ï¼‰

##### 2.1 å…¥å‚

> å’ŒControllerå±‚å…¥å‚ç±»ä¼¼ï¼Œæˆ‘ä»¬çº¦å®šå°†Serviceå±‚çš„å…¥å‚å°è£…ä¸º`AaaRequest â†’ AbstractRequest`
>
> - AaaVO
> - List< AaaVo >
> - â†’ PageInfo
>
> `AaaRequest`ä¸­éœ€è¦æä¾›Serviceå®ç°çš„å‚æ•°æ ¡éªŒæ–¹æ³•ã€‚

##### 2.2 å“åº”

> æˆ‘ä»¬çº¦å®šå“åº”åˆ†ä¸ºä¸¤ç§ï¼Œ<u>äºŒè€…å‡ç»§æ‰¿äº`AbstractResponse(code:String, msg:String)ğŸ””`</u>
>
> - ***<u>ğŸBaseResponse< T ></u>***
>   - T result
>   - long total
> - ***<u>ğŸDefaultResponse</u>***
>   - ç©º

##### 2.3 Serviceä¸­é€»è¾‘æ¨¡æ¿

> 2.3.1 ä¸‰ä¸ªåœ°æ–¹æ ‡è®°æ—¥å¿—é”šç‚¹ï¼ˆå¼€å§‹ã€ç»“æŸä¸å¼‚å¸¸ï¼‰
>
> 2.3.2 å‚æ•°æ ¡éªŒï¼ˆ`AaaRequest`ï¼‰
>
> 2.3.3 å®šä¹‰åˆå§‹åŒ–å“åº”ä½“responseã€total
>
> 2.3.4 ä»requestä¸­è§£æå‚æ•°
>
> 2.3.5 ã€ä¸šåŠ¡å¤„ç†ã€‘â† éœ€è¦æ•è·ä¸¤ç§å¼‚å¸¸ï¼ˆ`BaseExceptionå¼‚å¸¸åŸºç±»`å’Œ`Exception`ï¼‰
>
> - BaseExceptionå¼‚å¸¸åŸºç±»
>
>   - ```java
>     log.error(">>>>xxx|xxx|xxx:{}<<<", be.getMessage(), be)
>     throw new BizException(be.getErrorCode(), be.getMessage())
>     ```
>
> -  ExceptionæœªçŸ¥å¼‚å¸¸ğŸ‘‰<u>***ç»Ÿä¸€ä½¿ç”¨getMessageä½œä¸ºBizExceptionçš„æ¶ˆæ¯ä½“ ***</u>ï¼
>
>   -  ```java
>      log.error(">>>>xxx|xxx|xxx:{}<<<", e.getMessage(), e)
>      throw new BizException(SystemRetCodeConstants.SYSTEM_ERROR.getCode(), e.getMessage())
>      ```
>
> 2.3.6 å¡«å……å“åº”ä½“
>
> - <u>***total***</u>
> - <u>***result***</u>
> - <u>***code***</u>
> - <u>***msg***</u>





#### ğŸŒµæŸ¥è¯¢

##### 3.1æŸ¥è¯¢å‡åˆ†é¡µ

- æ˜¯å¦åˆ†é¡µç”±å‰ç«¯å‚æ•°æ§åˆ¶ï¼Œä¸åˆ†é¡µæ—¶å¯æ‰‹åŠ¨å°†åˆ†é¡µå‚æ•°è®¾ç½®è‡³MAX

##### 3.2 æŸ¥è¯¢ç»“æœæ”¾åœ¨åˆ†é¡µå¯¹è±¡ä¸­

- data
- total

##### 3.3 å…³äºç¼“å­˜ï¼ˆæ–¹æ¡ˆäºŒå®è·µï¼‰

> æ–¹æ¡ˆä¸€ï¼šç¼“å­˜æ‰€æœ‰æ•°æ®
>
> æ–¹æ¡ˆäºŒï¼šç¼“å­˜é¦–é¡µæ•°æ®ğŸš€

1. ç¼“å­˜é¦–é¡µæ•°æ®ï¼Œç¼“å­˜æ€»æ•°æ®æ¡æ•°
2. æŸ¥è¯¢è¯·æ±‚é¦–å…ˆè½åˆ°Redisï¼Œå½“æ²¡æœ‰å‘½ä¸­æˆ–Rediså¼‚å¸¸ï¼Œåˆ™è¯·æ±‚è½åˆ°DB
   1. åˆ¤æ–­æ˜¯å¦ä¸ºç¬¬ä¸€é¡µ
      1. æ•°æ®æ€»æ•°<=ç¬¬ä¸€é¡µæ•°é‡ && ç¼“å­˜è®°å½•æ•°==æ•°æ®æ€»æ•°ï¼Œä½¿ç”¨ç¼“å­˜ï¼ˆæ­¤æ—¶è¡¨ç¤ºä¸é€‚ç”¨ç¼“å­˜ï¼Œå…¨éƒ¨å±•ç¤ºï¼‰
      2. åˆ†é¡µå‚æ•°æ¯é¡µæ•°é‡å’Œç¼“å­˜ä¸­æ•°é‡ä¸€è‡´ï¼Œä½¿ç”¨ç¼“å­˜ï¼ˆæ­¤æ—¶ç¼“å­˜äº†ç¬¬ä¸€é¡µï¼‰
3. ä»DBæŸ¥è¯¢æ•°æ®è·å–ç»“æœåï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºç¬¬ä¸€é¡µï¼Œæ˜¯åˆ™ç¼“å­˜ï¼ˆç¼“å­˜å‰éœ€è¦æ¸…ç©ºç¼“å­˜ï¼‰







 

















